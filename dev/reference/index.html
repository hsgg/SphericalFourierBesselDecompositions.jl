<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · SphericalFourierBesselDecompositions.jl</title><meta name="title" content="Reference · SphericalFourierBesselDecompositions.jl"/><meta property="og:title" content="Reference · SphericalFourierBesselDecompositions.jl"/><meta property="twitter:title" content="Reference · SphericalFourierBesselDecompositions.jl"/><meta name="description" content="Documentation for SphericalFourierBesselDecompositions.jl."/><meta property="og:description" content="Documentation for SphericalFourierBesselDecompositions.jl."/><meta property="twitter:description" content="Documentation for SphericalFourierBesselDecompositions.jl."/><meta property="og:url" content="https://hsgg.github.io/SphericalFourierBesselDecompositions.jl/reference/"/><meta property="twitter:url" content="https://hsgg.github.io/SphericalFourierBesselDecompositions.jl/reference/"/><link rel="canonical" href="https://hsgg.github.io/SphericalFourierBesselDecompositions.jl/reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="SphericalFourierBesselDecompositions.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SphericalFourierBesselDecompositions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial_catalog/">Tutorial: Catalogue and Window</a></li><li><a class="tocitem" href="../tutorial_gnl/">Tutorial: Radial basis functions</a></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li><a class="tocitem" href="#SFB"><span>SFB</span></a></li><li><a class="tocitem" href="#SFB.GNLs"><span>SFB.GNLs</span></a></li><li><a class="tocitem" href="#SFB.Modes"><span>SFB.Modes</span></a></li><li><a class="tocitem" href="#SFB.SeparableArrays"><span>SFB.SeparableArrays</span></a></li><li><a class="tocitem" href="#SFB.Cat2Anlm"><span>SFB.Cat2Anlm</span></a></li><li><a class="tocitem" href="#SFB.Windows"><span>SFB.Windows</span></a></li><li><a class="tocitem" href="#SFB.WindowChains"><span>SFB.WindowChains</span></a></li><li><a class="tocitem" href="#SFB.Theory"><span>SFB.Theory</span></a></li><li><a class="tocitem" href="#SFB.MyBroadcast"><span>SFB.MyBroadcast</span></a></li><li><a class="tocitem" href="#SFB.MyBroadcast.MeshedArrays"><span>SFB.MyBroadcast.MeshedArrays</span></a></li></ul></li><li><a class="tocitem" href="../myindex/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/master/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><p>The functions in here are exported into the main module. We will often assume that the user has defined the shortcut to the module:</p><pre><code class="language-julia hljs">import SphericalFourierBesselDecompositions as SFB</code></pre><p>Then, all functions can be called via <code>SFB.funcname()</code>. For example, the <code>SFB.SphericalBesselGnl()</code> constructor in the <code>SFB.GNLs</code> module is called via <code>SFB.SphericalBesselGnl()</code>.</p><ul><li><a href="#Reference">Reference</a></li><li class="no-marker"><ul><li><a href="#SFB">SFB</a></li><li><a href="#SFB.GNLs">SFB.GNLs</a></li><li><a href="#SFB.Modes">SFB.Modes</a></li><li><a href="#SFB.SeparableArrays">SFB.SeparableArrays</a></li><li><a href="#SFB.Cat2Anlm">SFB.Cat2Anlm</a></li><li><a href="#SFB.Windows">SFB.Windows</a></li><li><a href="#SFB.WindowChains">SFB.WindowChains</a></li><li><a href="#SFB.Theory">SFB.Theory</a></li><li><a href="#SFB.MyBroadcast">SFB.MyBroadcast</a></li><li><a href="#SFB.MyBroadcast.MeshedArrays">SFB.MyBroadcast.MeshedArrays</a></li></ul></li></ul><h2 id="SFB"><a class="docs-heading-anchor" href="#SFB">SFB</a><a id="SFB-1"></a><a class="docs-heading-anchor-permalink" href="#SFB" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.calc_fsky-Tuple{Any, Any}" href="#SphericalFourierBesselDecompositions.calc_fsky-Tuple{Any, Any}"><code>SphericalFourierBesselDecompositions.calc_fsky</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_fsky(win, wmodes)</code></pre><p>This functions returns a measure of the sky fraction covered by the survey with window <code>win</code>. The exact implementation is considered an implementation detail and can change in the future.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/SphericalFourierBesselDecompositions.jl#L497-L503">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.pixwin-Tuple{Any}" href="#SphericalFourierBesselDecompositions.pixwin-Tuple{Any}"><code>SphericalFourierBesselDecompositions.pixwin</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pixwin(cmodes)

Return the angular pixel window for application to a Clnn object.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/SphericalFourierBesselDecompositions.jl#L153-L157">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.xyz2rtp-Tuple{Any}" href="#SphericalFourierBesselDecompositions.xyz2rtp-Tuple{Any}"><code>SphericalFourierBesselDecompositions.xyz2rtp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">xyz2rtp(xyz)</code></pre><p>Convert the Cartesian positions in <code>xyz</code> to spherical coordinates <code>rθϕ</code>. The first dimension is of length 3, the second is the number of galaxies. Assumes a flat geometry.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/SphericalFourierBesselDecompositions.jl#L510-L516">source</a></section></article><h2 id="SFB.GNLs"><a class="docs-heading-anchor" href="#SFB.GNLs">SFB.GNLs</a><a id="SFB.GNLs-1"></a><a class="docs-heading-anchor-permalink" href="#SFB.GNLs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.GNLs" href="#SphericalFourierBesselDecompositions.GNLs"><code>SphericalFourierBesselDecompositions.GNLs</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GNLs</code></pre><p>Module to define radial basis functions. The specific basis functions are defined in an enum, <code>BoundaryConditions</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/GNLs.jl#L37-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.GNLs.BoundaryConditions" href="#SphericalFourierBesselDecompositions.GNLs.BoundaryConditions"><code>SphericalFourierBesselDecompositions.GNLs.BoundaryConditions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BoundaryConditions</code></pre><p>This enum defines the radial basis functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/GNLs.jl#L53-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.GNLs.GNL-NTuple{4, Any}" href="#SphericalFourierBesselDecompositions.GNLs.GNL-NTuple{4, Any}"><code>SphericalFourierBesselDecompositions.GNLs.GNL</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GNL(nmax, lmax, rmin, rmax)
GNL(kmax, rmin, rmax; nmax=typemax(Int64), lmax=typemax(Int64))</code></pre><p>Generate <code>gnl(n,l,r)</code>. Returns a struct that can be called for calculating <code>gnl</code>. Note that the last argument is <code>r</code>, <em>not</em> <code>kr</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/GNLs.jl#L76-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.GNLs.SphericalBesselGNL-NTuple{4, Any}" href="#SphericalFourierBesselDecompositions.GNLs.SphericalBesselGNL-NTuple{4, Any}"><code>SphericalFourierBesselDecompositions.GNLs.SphericalBesselGNL</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SphericalBesselGNL(nmax, lmax, rmin, rmax)
SphericalBesselGNL(kmax, rmin, rmax; nmax=typemax(Int64), lmax=typemax(Int64))</code></pre><p>Generate <code>gnl(n,l,r)</code>. Returns a struct that can be called for calculating <code>gnl</code>. Note that the last argument is <code>r</code>, <em>not</em> <code>kr</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/SphericalBesselGNLs.jl#L606-L612">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.GNLs.calc_first_n_zeros-Tuple{Any, Any}" href="#SphericalFourierBesselDecompositions.GNLs.calc_first_n_zeros-Tuple{Any, Any}"><code>SphericalFourierBesselDecompositions.GNLs.calc_first_n_zeros</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_first_n_zeros(func, nmax; δ=π/20, xmin=0.0)</code></pre><p>Calculate the first <code>nmax</code> zeros of the function <code>func</code>. Assumes that zeros are spaced more than <code>δ</code> apart. First zero could be <code>xmin</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/SphericalBesselGNLs.jl#L169-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.GNLs.calc_knl-Tuple" href="#SphericalFourierBesselDecompositions.GNLs.calc_knl-Tuple"><code>SphericalFourierBesselDecompositions.GNLs.calc_knl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_knl(nmax, lmax, rmin, rmax; boundary=potential)
calc_knl(kmax, rmin, rmax; nmax=typemax(Int64), lmax=typemax(Int64), boundary=potential)</code></pre><p>Calculate the <code>knl</code> for boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/SphericalBesselGNLs.jl#L257-L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.GNLs.calc_zeros-Tuple{Any, Any, Any}" href="#SphericalFourierBesselDecompositions.GNLs.calc_zeros-Tuple{Any, Any, Any}"><code>SphericalFourierBesselDecompositions.GNLs.calc_zeros</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_zeros(func, xmin, xmax; δ=π/20)</code></pre><p>Calculate all zeros of the function <code>func</code> between <code>xmin</code> and <code>xmax</code>. Assumes that zeros are spaced more than <code>δ</code> apart.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/SphericalBesselGNLs.jl#L191-L196">source</a></section></article><h3 id="SFB.GNL.CryoGNLs"><a class="docs-heading-anchor" href="#SFB.GNL.CryoGNLs">SFB.GNL.CryoGNLs</a><a id="SFB.GNL.CryoGNLs-1"></a><a class="docs-heading-anchor-permalink" href="#SFB.GNL.CryoGNLs" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.GNLs.CryoGNLs" href="#SphericalFourierBesselDecompositions.GNLs.CryoGNLs"><code>SphericalFourierBesselDecompositions.GNLs.CryoGNLs</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>CryoGNLs</p><p>To generate the radial basis functions, first define the radial binning, e.g.,</p><pre><code class="language-julia hljs">rmin = 1000.0
rmax = 4000.0
nbins = 1000
Δr = (rmax - rmin) / nbins
rmid = range(rmin + Δr/2, rmax - Δr/2, length=nbins)</code></pre><p>Then, to generate the radial basis functions at <code>ℓ=3</code>,</p><pre><code class="language-julia hljs">ell = 3
k, g, ginv = CryoGNLs.get_radial_cryofunks(ell, rmid, Δr)</code></pre><p>The functions <code>gnl(r)</code> are now saved in <code>g</code>, so that <code>g[i,n]</code> is <code>gnl(rmid[i])</code> and the corresponding <code>k</code>-mode is <code>k[n]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/CryoGNLs.jl#L8-L26">source</a></section></article><h2 id="SFB.Modes"><a class="docs-heading-anchor" href="#SFB.Modes">SFB.Modes</a><a id="SFB.Modes-1"></a><a class="docs-heading-anchor-permalink" href="#SFB.Modes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Modes.AnlmModes" href="#SphericalFourierBesselDecompositions.Modes.AnlmModes"><code>SphericalFourierBesselDecompositions.Modes.AnlmModes</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AnlmModes(kmax, rmin, rmax; cache=true, nside=nothing, boundary=SFB.GNL.potential)
AnlmModes(nmax, lmax, rmin, rmax; cache=true, nside=nothing, boundary=SFB.GNL.potential)</code></pre><p>This is where we define which modes are included. As our criterium, we set a maximum qmax = kmax * rmax, and we include all modes below that.</p><p>The modes are arranged in the following order. The fastest loop is through &#39;m&#39;, then &#39;l&#39;, finally &#39;n&#39;, from small number to larger number. We restrict &#39;m&#39; to m &gt;= 0, and we assume a real field.</p><p>Example:</p><pre><code class="language-julia-repl hljs">julia&gt; kmax = 0.05
julia&gt; rmin = 500.0
julia&gt; rmax = 1000.0
julia&gt; modes = AnlmModes(kmax, rmin, rmax)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/modes.jl#L73-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Modes.ClnnModes" href="#SphericalFourierBesselDecompositions.Modes.ClnnModes"><code>SphericalFourierBesselDecompositions.Modes.ClnnModes</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ClnnModes(::AnlmModes)
ClnnModes(::AnlmModes, ::AnlmModes)</code></pre><p>This is where we define which modes are included in the power spectrum, given a <code>AnlmModes</code> struct.</p><p>The modes are arranged in the following order. The fastest loop is through &#39;n̄&#39;, then &#39;Δn&#39;, finally &#39;ℓ&#39;, from small number to larger number. We make the convention that <code>n̄</code> is the smaller of the k-modes, and <code>Δn &gt;= 0</code>.</p><p>More useful is the labeling by <code>ℓ, n₁, n₂</code>. In that case we make the convention that <code>n₁ = n̄</code> and <code>n₂ = n̄ + Δn</code>.</p><p>If two <code>AnlmModes</code> are given, then we assume a cross-correlation is desired. The <code>S</code> parameter specifies whether the resulting modes are symmetric (S=true) on interchange of k1 and k2, or not (S=false). This is useful for auto- and cross-correlation, respectively.</p><p>There is some ambiguity in what exactly the <code>S</code> parameter encodes. First, it could encode purely the symmetry of the Clnn modes, or it could encode whether we are doing a cross-correlation or an auto-correlation. Are these two equivalent? Can we ever have a symmetric cross-correlation? We define the cross-correlation as <code>&lt;delta^A delta^{B,*}&gt;, so that for a fixed</code>l<code>,</code>Clnn^{AB}<code>is the transpose of</code>Clnn^{BA}`.</p><p>For the purposes of <code>ClnnModes</code>, the <code>S</code> parameter shall encode whether the two amodes are equal or not. That is, <code>S = (amodesA==amodesB)</code>. Whether it encodes any symmetry <code>A==B</code> beyond that will be left to the application using <code>ClnnModes</code>. The recommendation is to indeed use it to encode <code>A==B</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/modes.jl#L237-L267">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Modes.getlkk-Tuple{SphericalFourierBesselDecompositions.Modes.ClnnModes, Any}" href="#SphericalFourierBesselDecompositions.Modes.getlkk-Tuple{SphericalFourierBesselDecompositions.Modes.ClnnModes, Any}"><code>SphericalFourierBesselDecompositions.Modes.getlkk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getlkk(::ClnnModes, [i])
getlkk(::ClnnBinnedModes, [i])</code></pre><p>Get the physical modes ℓ, k, and k&#39; corresponding to the index <code>i</code>. If <code>i</code> is left out, an array <code>lkk</code> of all modes is returned so that <code>lkk[1,:]</code> are all the ℓ-values, <code>lkk[2,:]</code> all the k-values, and <code>lkk[3,:]</code> are all the k&#39;-values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/modes.jl#L491-L499">source</a></section></article><h2 id="SFB.SeparableArrays"><a class="docs-heading-anchor" href="#SFB.SeparableArrays">SFB.SeparableArrays</a><a id="SFB.SeparableArrays-1"></a><a class="docs-heading-anchor-permalink" href="#SFB.SeparableArrays" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.SeparableArrays.exponentiate-Tuple{SphericalFourierBesselDecompositions.SeparableArrays.SeparableArray, Number}" href="#SphericalFourierBesselDecompositions.SeparableArrays.exponentiate-Tuple{SphericalFourierBesselDecompositions.SeparableArrays.SeparableArray, Number}"><code>SphericalFourierBesselDecompositions.SeparableArrays.exponentiate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exponentiate(s::SeparableArray, exp::Number)</code></pre><p>This function is used for elementwise exponentiation of the array &#39;s&#39;. It could be made more elegant by extending the broadcast syntax. PRs welcome.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/SeparableArrays.jl#L135-L140">source</a></section></article><h2 id="SFB.Cat2Anlm"><a class="docs-heading-anchor" href="#SFB.Cat2Anlm">SFB.Cat2Anlm</a><a id="SFB.Cat2Anlm-1"></a><a class="docs-heading-anchor-permalink" href="#SFB.Cat2Anlm" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Cat2Anlm.anlm2field-Tuple{Any, SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes, Any}" href="#SphericalFourierBesselDecompositions.Cat2Anlm.anlm2field-Tuple{Any, SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes, Any}"><code>SphericalFourierBesselDecompositions.Cat2Anlm.anlm2field</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">anlm2field(f_nlm, wmodes::ConfigurationSpaceModes, amodes)</code></pre><p>Transform the SFB coefficients <code>f_nlm</code> into configuration space. The resulting matrix will be of the form <code>nr × npix</code>, where <code>nr</code> is the number of radial bins given by <code>wmodes</code>, and <code>npix</code> is the number of HEALPixels.</p><p>For <code>wmodes</code> see <a href="#SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes-NTuple{4, Any}"><code>ConfigurationSpaceModes</code></a>. For <code>amodes</code> see <a href="#SphericalFourierBesselDecompositions.Modes.AnlmModes"><code>AnlmModes</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/cat2anlm.jl#L333-L342">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Cat2Anlm.cat2amln" href="#SphericalFourierBesselDecompositions.Cat2Anlm.cat2amln"><code>SphericalFourierBesselDecompositions.Cat2Anlm.cat2amln</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cat2amln(rθϕ, amodes, nbar, win_rhat_ln, weights)</code></pre><p>Computes the spherical Fourier-Bessel decomposition coefficients from a catalogue of sources. The number density is measured from the survey as <span>$\bar n = N_\mathrm{gals} / V_\mathrm{eff}$</span>.</p><p><code>weights</code> is an array containing a weight for each galaxy.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using SphericalFourierBesselDecompositions
julia&gt; cat2amln(rθϕ, ...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/cat2anlm.jl#L242-L256">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Cat2Anlm.field2anlm-Tuple{Any, SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes, Any}" href="#SphericalFourierBesselDecompositions.Cat2Anlm.field2anlm-Tuple{Any, SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes, Any}"><code>SphericalFourierBesselDecompositions.Cat2Anlm.field2anlm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">field2anlm(f_xyz, wmodes::ConfigurationSpaceModes, amodes)</code></pre><p>Calculate the SFB coefficients for the real field <code>f_xyz</code>, where the real field is in the format of an <code>nr × npix</code> matrix.</p><p>For <code>wmodes</code> see <a href="#SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes-NTuple{4, Any}"><code>ConfigurationSpaceModes</code></a>. For <code>amodes</code> see <a href="#SphericalFourierBesselDecompositions.Modes.AnlmModes"><code>AnlmModes</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/cat2anlm.jl#L315-L323">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Cat2Anlm.winweights2galweights-Tuple{Any, Any, Any}" href="#SphericalFourierBesselDecompositions.Cat2Anlm.winweights2galweights-Tuple{Any, Any, Any}"><code>SphericalFourierBesselDecompositions.Cat2Anlm.winweights2galweights</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">winweights2galweights(weights, wmodes, rθϕ)</code></pre><p>Returns an array with the weight for each galaxy. <code>weights</code> is a 2D-array where the first index goes over <code>r</code>, the second over healpix pixel <code>p</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/cat2anlm.jl#L212-L217">source</a></section></article><h2 id="SFB.Windows"><a class="docs-heading-anchor" href="#SFB.Windows">SFB.Windows</a><a id="SFB.Windows-1"></a><a class="docs-heading-anchor-permalink" href="#SFB.Windows" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes-NTuple{4, Any}" href="#SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes-NTuple{4, Any}"><code>SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConfigurationSpaceModes(rmin, rmax, nr, nside)</code></pre><p>A struct to describe and define the voxelization scheme.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/windows.jl#L93-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes-Tuple{SphericalFourierBesselDecompositions.Modes.AnlmModes, Any}" href="#SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes-Tuple{SphericalFourierBesselDecompositions.Modes.AnlmModes, Any}"><code>SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConfigurationSpaceModes(amodes, nr)</code></pre><p>A struct to describe voxelization scheme, initialized from an <code>AnlmModes</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/windows.jl#L106-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Windows.apply_window-Union{Tuple{T}, Tuple{AbstractArray{T}, Vararg{Any, 5}}} where T&lt;:Real" href="#SphericalFourierBesselDecompositions.Windows.apply_window-Union{Tuple{T}, Tuple{AbstractArray{T}, Vararg{Any, 5}}} where T&lt;:Real"><code>SphericalFourierBesselDecompositions.Windows.apply_window</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_window(rθϕ, win, wmodes::ConfigurationSpaceModes; rng=Random.GLOBAL_RNG)
apply_window(rθϕ::AbstractArray{T}, win, rmin, rmax, win_r, win_Δr; rng=Random.GLOBAL_RNG) where {T&lt;:Real}</code></pre><p>The function <code>apply_window()</code> takes a sample of points in <code>rθϕ</code> and filters out points with probability specified by <code>1-win/maximum(win)</code>. Thus, all points are retained where <code>win == maximum(win)</code>, and points are filtered out with proportional probability so that none are kept where <code>win &lt;= 0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/windows.jl#L160-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Windows.power_win_mix-Tuple{Any, Any, SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes, SphericalFourierBesselDecompositions.Modes.ClnnModes}" href="#SphericalFourierBesselDecompositions.Windows.power_win_mix-Tuple{Any, Any, SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes, SphericalFourierBesselDecompositions.Modes.ClnnModes}"><code>SphericalFourierBesselDecompositions.Windows.power_win_mix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">power_win_mix(win1, win2, wmodes, cmodes; div2Lp1=false, interchange_NN′=false)
power_win_mix(win1, win2, w̃mat, vmat, wmodes, bcmodes; div2Lp1=false, interchange_NN′=false)
power_win_mix(wmix, wmix_negm, cmodes)</code></pre><p>This function is used to calculate the coupling matrix <span>$\mathcal{M}_{\ell nn&#39;}^{LNN&#39;}$</span> – the first version without any binning, the second version also takes the binning matrices <code>w̃mat</code> and <code>vmat</code> to calculate the coupling matrix of the binned modes <span>$\mathcal{N}_{LNN&#39;}^{lnn&#39;}$</span>. These assume the symmetry between <span>$N$</span> and <span>$N&#39;$</span>.</p><p>The last version is probably not useful except for testing. It takes a fully calculated window mixing matrix to calculate the coupling matrix brute-force.</p><p>If <code>div2Lp1=true</code> then the whole matrix is divided by <span>$2L+1$</span>.</p><p>If <code>interchange_NN′=true</code> then calculate the same, but with <span>$N$</span> and <span>$N&#39;$</span> interchanged, which might be useful for the covariance matrix.</p><p>Either version of <code>power_win_mix()</code> will specialize to a separable window function if <code>win</code> is a <code>SeparableArray</code>.</p><p>The basic usage is to multiply the power spectrum Clnn by this matrix, and the assuption is that there is symmetry in the exchange of <code>k_n</code> and <code>k_n′</code>. (Note that this assumed symmetry, however, destroyes the symmetry in the coupling matrix.)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/windows.jl#L754-L780">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Windows.window_r-Tuple{SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes}" href="#SphericalFourierBesselDecompositions.Windows.window_r-Tuple{SphericalFourierBesselDecompositions.Windows.ConfigurationSpaceModes}"><code>SphericalFourierBesselDecompositions.Windows.window_r</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">window_r(wmodes::ConfigurationSpaceModes)</code></pre><p>Get the <span>$r$</span>-values of the radial bins and corresponding widths <span>$\Delta r$</span>, e.g.,</p><pre><code class="language-julia hljs">r, Δr = SFB.window_r(wmodes)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/windows.jl#L117-L124">source</a></section></article><h2 id="SFB.WindowChains"><a class="docs-heading-anchor" href="#SFB.WindowChains">SFB.WindowChains</a><a id="SFB.WindowChains-1"></a><a class="docs-heading-anchor-permalink" href="#SFB.WindowChains" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.WindowChains" href="#SphericalFourierBesselDecompositions.WindowChains"><code>SphericalFourierBesselDecompositions.WindowChains</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WindowChains</code></pre><p>This module exposes several ways to calculate a chain of window functions. All require a cache to be created that speeds up subsequent calls. The type of cache determines which method is used.</p><p>To create the cache, simply call one of</p><pre><code class="nohighlight hljs">julia&gt; cache = SFB.WindowChains.WindowChainsCacheWignerChain(win, wmodes, amodes)
julia&gt; cache = SFB.WindowChains.WindowChainsCacheFullWmix(win, wmodes, amodes)
julia&gt; cache = SFB.WindowChains.WindowChainsCacheFullWmixOntheflyWmix(win, wmodes, amodes)
julia&gt; cache = SFB.WindowChains.WindowChainsCacheSeparableWmix(win, wmodes, amodes)
julia&gt; cache = SFB.WindowChains.WindowChainsCacheSeparableWmixOntheflyWlmlm(win, wmodes, amodes)
julia&gt; cache = SFB.WindowChainsCache(win, wmodes, amodes)</code></pre><p>The last one will automatically select the typically fastest algorithm.</p><p>Then to calculate an element of a chain of windows, use <code>window_chain(ell, n1, n2, cache)</code>. For example, for a chain of four windows,</p><pre><code class="nohighlight hljs">julia&gt; ell = [0, 1, 2, 3]
julia&gt; n1 = [1, 2, 3, 4]
julia&gt; n2 = [5, 6, 7, 8]
julia&gt; Wk = SFB.window_chain(ell, n1, n2, cache)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/window_chains.jl#L31-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.WindowChains.window_chain-NTuple{5, Any}" href="#SphericalFourierBesselDecompositions.WindowChains.window_chain-NTuple{5, Any}"><code>SphericalFourierBesselDecompositions.WindowChains.window_chain</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">window_chain(ell, n1, n2, cache, symmetries)</code></pre><p>This version adds up several window chains taking into account the <code>symmetries</code>. <code>symmetries</code> is an array of pairs of numbers specifying the symmetries to consider. Each pair specifies the <code>ℓnn′</code> index and the type of symmetry. For example, when <code>k≥3</code>, then <code>symmetries = [1=&gt;0, 2=&gt;1, 3=&gt;2]</code> would specify that no symmetries are taken into account for the first <code>lnn′</code> combination, the second symmetry will flip <code>n</code> and <code>n′</code> and add the result only when <code>n ≠ n′</code>, and the third will add the result regardless whether the <code>n</code> equal or not.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/window_chains.jl#L279-L290">source</a></section></article><h2 id="SFB.Theory"><a class="docs-heading-anchor" href="#SFB.Theory">SFB.Theory</a><a id="SFB.Theory-1"></a><a class="docs-heading-anchor-permalink" href="#SFB.Theory" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Theory.calc_C4-NTuple{5, Any}" href="#SphericalFourierBesselDecompositions.Theory.calc_C4-NTuple{5, Any}"><code>SphericalFourierBesselDecompositions.Theory.calc_C4</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_C4(C_th, cmix_W, cmix_wW, Veff, cmodes)</code></pre><p>Calculate the observed power spectrum including the local average effect for a constant nbar.</p><p>The <code>method</code> is by default an approximate formula.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/theory.jl#L338-L345">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Theory.calc_NobsA-NTuple{6, Any}" href="#SphericalFourierBesselDecompositions.Theory.calc_NobsA-NTuple{6, Any}"><code>SphericalFourierBesselDecompositions.Theory.calc_NobsA</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_NobsA(NwW_th, NW_th, cmix_wW, nbar, Veff, cmodes)</code></pre><p>Calculate the observed shot noise including the local average effect for a constant nbar.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/theory.jl#L204-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.Theory.calc_NobsA_z-NTuple{8, Any}" href="#SphericalFourierBesselDecompositions.Theory.calc_NobsA_z-NTuple{8, Any}"><code>SphericalFourierBesselDecompositions.Theory.calc_NobsA_z</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_NobsA_z(NwW_th, nbar, cmodes, amodes_red, wWmix, wWmix_negm, wWtildemix, wWtildemix_negm)</code></pre><p>Calculate the observed shot noise including the local average effect for measured nbar(z).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/theory.jl#L226-L231">source</a></section></article><h2 id="SFB.MyBroadcast"><a class="docs-heading-anchor" href="#SFB.MyBroadcast">SFB.MyBroadcast</a><a id="SFB.MyBroadcast-1"></a><a class="docs-heading-anchor-permalink" href="#SFB.MyBroadcast" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.MyBroadcast" href="#SphericalFourierBesselDecompositions.MyBroadcast"><code>SphericalFourierBesselDecompositions.MyBroadcast</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MyBroadcast</code></pre><p>This module defines the function <code>mybroadcast</code>. It behave similarly to a threaded broadcast, except that it tries to batch iterations such that each batch takes about 0.5 seconds to perform.</p><p>The idea is to automatically adjust the number of iterations per batch so that overhead per iteration is low and batch size is small so that the threads keep getting scheduled.</p><p>For example, imagine that the execution time per iteration increases. With a static scheduler, this would mean that the first threads finish long before the last thread. This avoids that by adjusting the number of iterations so that each batch should take approximately 0.5 seconds.</p><p>So why batch iterations? Imagine you need to allocate a buffer for each iteration, and this buffer can be shared for sequentially run iterations. Allocating a separate buffer would add a lot of overhead, so that traditional <code>map()</code> can take longer than the serial implementation. Batching avoids that pitfall.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/MyBroadcast.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.MyBroadcast.mybroadcast-Tuple{Any, Vararg{Any}}" href="#SphericalFourierBesselDecompositions.MyBroadcast.mybroadcast-Tuple{Any, Vararg{Any}}"><code>SphericalFourierBesselDecompositions.MyBroadcast.mybroadcast</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mybroadcast(fn, x...; num_threads=Threads.nthreads())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/MyBroadcast.jl#L150-L152">source</a></section></article><h2 id="SFB.MyBroadcast.MeshedArrays"><a class="docs-heading-anchor" href="#SFB.MyBroadcast.MeshedArrays">SFB.MyBroadcast.MeshedArrays</a><a id="SFB.MyBroadcast.MeshedArrays-1"></a><a class="docs-heading-anchor-permalink" href="#SFB.MyBroadcast.MeshedArrays" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFourierBesselDecompositions.MyBroadcast.MeshedArrays" href="#SphericalFourierBesselDecompositions.MyBroadcast.MeshedArrays"><code>SphericalFourierBesselDecompositions.MyBroadcast.MeshedArrays</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MeshedArrays</code></pre><p>A &#39;MeshedArray&#39; struct is a kind of view into a smaller array &#39;x&#39;. It is useful for treating a 1D array as a 2D array ignoring one of the dimensions. A &#39;MeshedArray&#39; is an &#39;AbstractArray&#39;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsgg/SphericalFourierBesselDecompositions.jl/blob/bd166114c8032652a4b452bb0902e8d8f65a6fa3/src/MeshedArrays.jl#L1-L7">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial_gnl/">« Tutorial: Radial basis functions</a><a class="docs-footer-nextpage" href="../myindex/">Index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 29 May 2025 04:39">Thursday 29 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
